From f69214b4dfcc7299851800ce391ef50116155a47 Mon Sep 17 00:00:00 2001
From: "Dirk-Jan C. Binnema" <djcb@djcbsoftware.nl>
Date: Thu, 29 Jul 2021 23:24:13 +0300
Subject: [PATCH 1/2] mu4e-main: refresh after context-switch

Fixes: #2062.
---
 mu4e/mu4e-context.el | 2 +-
 mu4e/mu4e-main.el    | 6 ++++--
 2 files changed, 5 insertions(+), 3 deletions(-)

diff --git a/mu4e/mu4e-context.el b/mu4e/mu4e-context.el
index cac511f6..afecb4ac 100644
--- a/mu4e/mu4e-context.el
+++ b/mu4e/mu4e-context.el
@@ -1,6 +1,6 @@
 ;;; mu4e-context.el -- part of mu4e, the mu mail user agent -*- lexical-binding: t -*-
 
-;; Copyright (C) 2015-2020 Dirk-Jan C. Binnema
+;; Copyright (C) 2015-2021 Dirk-Jan C. Binnema
 
 ;; Author: Dirk-Jan C. Binnema <djcb@djcbsoftware.nl>
 ;; Maintainer: Dirk-Jan C. Binnema <djcb@djcbsoftware.nl>
diff --git a/mu4e/mu4e-main.el b/mu4e/mu4e-main.el
index 74243957..839ccf6b 100644
--- a/mu4e/mu4e-main.el
+++ b/mu4e/mu4e-main.el
@@ -70,7 +70,8 @@ no unread messages.")
 
     (define-key map "S" 'mu4e-kill-update-mail)
     (define-key map  (kbd "C-S-u") 'mu4e-update-mail-and-index)
-    (define-key map ";" 'mu4e-context-switch)
+    (define-key map ";"
+      (lambda()(interactive)(mu4e-context-switch)(revert-buffer)))
 
     (define-key map "$" 'mu4e-show-log)
     (define-key map "A" 'mu4e-about)
@@ -256,7 +257,8 @@ When REFRESH is non nil refresh infos from server."
        "\n"
        (propertize "  Misc\n\n" 'face 'mu4e-title-face)
 
-       (mu4e~main-action-str "\t* [;]Switch context\n" 'mu4e-context-switch)
+       (mu4e~main-action-str "\t* [;]Switch context\n"
+                             (lambda()(interactive)(mu4e-context-switch)(revert-buffer)))
 
        (mu4e~main-action-str "\t* [U]pdate email & database\n"
                              'mu4e-update-mail-and-index)
-- 
2.32.0

