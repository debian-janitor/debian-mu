This is mu4e.info, produced by makeinfo version 4.13 from mu4e.texi.

INFO-DIR-SECTION Emacs
START-INFO-DIR-ENTRY
* mu4e: (mu4e).        An email client for emacs based on mu.
END-INFO-DIR-ENTRY
   Copyright (C) 2012 Dirk-Jan C. Binnema

     Permission is granted to copy, distribute and/or modify this
     document under the terms of the GNU Free Documentation License,
     Version 1.3 or any later version published by the Free Software
     Foundation; with no Invariant Sections, no Front-Cover Texts, and
     no Back-Cover Texts.  A copy of the license is included in the
     section entitled "GNU Free Documentation License."


File: mu4e.info,  Node: Top,  Next: Introduction,  Up: (dir)

mu4e Manual
***********

Welcome to mu4e!

   mu4e (_mu-for-emacs_) is an e-mail client for GNU Emacs (version 23
and later). It is built on top of the mu e-mail search engine. This
manual describes how to set up and use mu4e.

* Menu:

* Introduction::
* Getting started::
* Running mu4e::
* Searching mail::
* Interaction with other tools::
* Example configuration::
* FAQ - Frequently Anticipated Questions::
* Known issues / missing features::

Appendices
* How it works:: Some notes about the implementation of mu4e
* GNU Free Documentation License::  The license of this manual.


File: mu4e.info,  Node: Introduction,  Next: Getting started,  Prev: Top,  Up: Top

1 Introduction
**************

In this chapter some prelimary thoughs about the how and why of mu4e.

* Menu:

* Why another e-mail client?::
* Other mail clients::
* What mu4e does and doesn't do::


File: mu4e.info,  Node: Why another e-mail client?,  Next: Other mail clients,  Up: Introduction

1.1 Why another e-mail client?
==============================

Why would the world need another e-mail client?  Well, I'm not sure the
world really _needs_ another one, but maybe _I_ do! I spend a _lot_ of
time, professionally and privately, dealing with e-mail - having an
efficient e-mail client is essential for me. Since none of the existing
ones worked they I wanted, I created my own.

   Still, while having been created for such selfish motives, mu4e tries
hard to be as useful as possible for all its users - suggestions are
very welcome and are acted upon.


File: mu4e.info,  Node: Other mail clients,  Next: What mu4e does and doesn't do,  Prev: Why another e-mail client?,  Up: Introduction

1.2 Other mail clients
======================

Under the hood, mu4e is fully search-based, similar to programs such as
notmuch(1), md(2) and sup(3). The user-interface is quite different
though.

   mu4e's mail handling (deleting, moving etc.) is inspired by
_Wanderlust_(4) (another emacs-based e-mail client), mutt(5) and dired,
while it takes some cues from _GMail_.

   mu4e tries to keep all the 'state' in your maildirs, so one can
switch between clients, synchronize over IMAP or backup with rsync - if
you delete the database, you won't lose any information.

   ---------- Footnotes ----------

   (1) `http://notmuchmail.org'

   (2) `https://github.com/nicferrier/md'

   (3) `http://sup.rubyforge.org/'

   (4) `http://www.gohome.org/wl/'

   (5) `http://www.mutt.org/'


File: mu4e.info,  Node: What mu4e does and doesn't do,  Prev: Other mail clients,  Up: Introduction

1.3 What mu4e does and doesn't do
=================================

mu, and, by extension, mu4e, do _not_ deal with getting your e-mail
messages from a mail server; instead, this task is delegated to other
tools, such as offlineimap(1), isync(2) or fetchmail(3). As long as the
messages end up in a Maildir, mu4e/mu are happy to deal with them.

   mu4e also does _not_ implement sending messages; instead, it depends
on the true-and-tested _smtpmail_, which is part of emacs. In addition,
mu4e piggybacks on Gnus' message editor; *note Gnus message editor:
(message)Top.

   Thus, many of the traditional things an e-mail client needs to do,
are subcontracted to other tools. This leaves mu4e to concentrate on
what it does best: quick message searching, reading mails, replying
them, moving messages around and so on.

   ---------- Footnotes ----------

   (1) `http://offlineimap.org/'

   (2) `http://isync.sourceforge.net/'

   (3) `http://www.fetchmail.info/'


File: mu4e.info,  Node: Getting started,  Next: Running mu4e,  Prev: Introduction,  Up: Top

2 Getting started
*****************

In this chapter, we go through installing mu4e and see how to set it
up. After we have succeeded in *note Getting mail::, and *note Indexing
your messages::, we discuss *note Basic configuration::.

   After going through these steps, mu4e should be ready for use.

* Menu:

* Installation::
* Getting mail::
* Indexing your messages::
* Sending mail::
* Queuing mail::
* Basic configuration::


File: mu4e.info,  Node: Installation,  Next: Getting mail,  Up: Getting started

2.1 Installation
================

mu4e is part of mu - by installing the latter, the former will be
installed as well.

   At the time of writing, there are no distribution packages for mu4e
yet, so we are assuming installation from source packages.

   First, you need make sure you have the necessary dependencies. On a
Debian or Ubuntu system, you can get these with:

     sudo apt-get install libgmime-2.4-dev libxapian-dev
     # emacs if you don't have it yet
     sudo apt-get install emacs23
     # optional
     sudo apt-get install guile-2.0-dev html2text xdg-utils

   Installation follows the normal sequence of:
     $ tar xvfz mu-<version>.tar.gz  # use the specific version
     $ cd mu-<version>
     $./configure && make
     $ sudo make install

   After this, mu and mu4e should be installed (1), and be available
from the command line and emacs (respectively). You may need to restart
emacs so it can pick up mu4e.

2.1.1 mu4e and emacs customization
----------------------------------

There is _experimental_ support for using the emacs customization
system in mu4e, but for now we recommend setting the values manually.
Please refer to *note Example configuration:: for a couple of examples
of this.

   ---------- Footnotes ----------

   (1) there's a hard dependency between versions of mu4e and mu - you
cannot combine different versions.


File: mu4e.info,  Node: Getting mail,  Next: Indexing your messages,  Prev: Installation,  Up: Getting started

2.2 Getting mail
================

In order for mu (and, by extension, mu4e) to work, we need to have our
e-mail messages stored in a Maildir. If you were already using
Maildirs, you are lucky; otherwise, you will need to get your mail
there in some way.

   If you are using some external IMAP or POP server, you can use tools
like getmail, offlineimap or isync to download your message into a
Maildir-directory (`~/Maildir', usually). If you are using a local
mail-server (such as _Postfix_ or qmail), you can teach them to deliver
into a Maildir as well, maybe in combination with procmail. A bit of
googling should be able to provide you with the details; also there is
full example of setting mu4e up with offlineimap and Gmail; *note Gmail
configuration::.

   You can do all of the mail retrieval _outside_ of emacs/mu4e, but
you can also do it from the mu4e. For that, set the variable
`mu4e-get-mail-command' to the command you want to use for retrieving
mail, which you can then access from the *note Main view::.

   You can also have this command run periodically (in the background),
by setting the variable `mu4e-update-interval' to the number of seconds
between such updates. If set to `nil', it will not update at all. Note
that if you make changes to `mu4e-update-interval', `mu4e' must be
restarted before the change will take effect.


File: mu4e.info,  Node: Indexing your messages,  Next: Sending mail,  Prev: Getting mail,  Up: Getting started

2.3 Indexing your messages
==========================

After you have succeeded in *note Getting mail::, we need to _index_ the
messages. That is - we need to scan the Maildir and store the
information about the mails into a special database. We can do that
from `mu4e' - *note Main view::, but this first time, it's better to
run it from the command line, as it may be easier to recognize problems.

   Assuming that your Maildir is at `~/Maildir', you should give the
following command:
       $ mu index --maildir=~/Maildir

   This should scan your `~/Maildir'(1) and fill the database, and give
progress information while doing so. The first time you index your mail
may take a few minutes (for thousands of e-mails), afterwards it is
much faster since it only has to scan the differences.

   Note that indexing is discussed at length in the mu-index man page.

   After the indexing is finished, you can quickly test if everything
worked, by trying some command line searches, for example
       $ mu find hello
   which should list all messages that match hello. For some more
examples of searches *Note Queries::, or check the mu-find and mu-easy
man pages.

   If all of this worked well, we are almost ready to start mu4e; we
only need set up *note Sending mail::.

   ---------- Footnotes ----------

   (1) In most cases, you do not even have to provide the
-maildir=~/Maildir; see the mu-index man-page for details


File: mu4e.info,  Node: Sending mail,  Next: Queuing mail,  Prev: Indexing your messages,  Up: Getting started

2.4 Sending mail
================

mu4e re-uses Gnu's message mode *note ()message::, for writing mail and
inherits the setup for _sending_ mail from that.

   For sending mail using SMTP, mu4e uses Emacs' standard smtpmail
package - *note ()smtpmail::. This package support many different ways
to send mail, please refer to its documentation for the details. Here
we only provide some simple examples - and *note Example
configuration::.

   A very minimal setup could look something like:

     ;; tell message-mode how to send mail
     (setq message-send-mail-function 'smtpmail-send-it)
     ;; if our mail server lives at smtp.example.org; if you have a local
     ;; mail-server, simply use 'localhost' here.
     (setq smtpmail-smtp-server "smtp.example.org")

   Note, since mu4e uses the same message mode and smtpmail that Gnus
uses, any setting for those will also work for mu4e.

   By default, mu4e puts a copy of any messages you sent in the folder
you set for `mu4e-sent-folder'. In some case, this may not be what you
want - for example, when using GMail+IMAP (but _not_ with GMail+POP3),
this interferes with GMail's handling of the sent messages folder, and
you may end up with duplicate messages. For this, since mu4e 0.9.8.3,
there is the variable `mu4e-sent-messages-behavior', which takes a
symbol. The default is `'sent' which, as mentioned, causes the message
to be copied to your sent-messages folder. Other possible values are
`'trash' (so the sent message is copied to the trash-folder
(`mu4e-trash-folder'), and `'delete' to simply discard the message
altogether.

   Thus, for GMail-IMAP you can add the following to your settings:

;; don't save message to Sent Messages, GMail/IMAP will take care of this
(setq mu4e-sent-messages-behavior 'trash)


File: mu4e.info,  Node: Queuing mail,  Next: Basic configuration,  Prev: Sending mail,  Up: Getting started

2.5 Queuing mail
================

If you cannot send mail directly, for example because you are currently
offline, you can _queue_ the mail, and send it when you have restored
your internet connection. You can control this from the mu4e *Note Main
view::.

   To allow for queuing, you need to tell smtpmail where you want to do
this. For example:

     (setq
         smtpmail-queue-mail  nil  ;; start in non-queuing mode
         smtpmail-queue-dir   "~/Maildir/queue/cur")

   For convenience, we locate the queue directory somewhere in our
normal Maildir. If you want to use queued mail, you should create this
directory before starting mu4e. The `mu mkdir' command can be handy
here, so for example:

$ mu mkdir ~/Maildir/queue
$ touch ~/Maildir/queue/.noindex

   The `touch' command tells mu to ignore this directory for indexing,
which makes sense since it contains smtpmail meta-data rather than
'normal' messages.

   Also, see the mu-mkdir and mu-index man pages.

   _Warning_: when you switch on queued-mode, your messages will not
reach their destination until you switch it off again; so, be careful
not to do so accidentally.


File: mu4e.info,  Node: Basic configuration,  Prev: Queuing mail,  Up: Getting started

2.6 Basic configuration
=======================

The last thing to do before running mu4e is setting up some basic
configuration. A good place to put this would be in your `~/.emacs'
file.  First some more extensive configuration, *Note Example
configuration::.

   First, we need to load mu4e:

     (require 'mu4e)

   Then, we need to tell mu4e where it can find your Maildir, and some
special folders. So, for example:
       (setq
         mu4e-maildir       "~/Maildir"   ;; top-level Maildir
         mu4e-sent-folder   "/sent"       ;; where do i keep sent mail?
         mu4e-drafts-folder "/drafts"     ;; where do i keep half-written mail?
         mu4e-trash-folder  "/trash")     ;; where do i move deleted mail?

   `mu4e-maildir' take an actual filesystem-path, the other folder
names are all relative to `mu4e-maildir'.


File: mu4e.info,  Node: Running mu4e,  Next: Searching mail,  Prev: Getting started,  Up: Top

3 Running mu4e
**************

After the following the steps in *note Getting started::, we should now
have a working mu4e setup. In this chapter, we'll give a tour of the
mu4e program, and show its use.

   mu4e consists of a number of views; the diagram shows how they
relate to each other, and the default key-bindings to get from one view
to the next. In the next sections we will describe what these keys
actually _do_.

* Menu:

* Main view::
* Headers view::
* Message view::
* Editor view::

     ----------------------------------------------------------------------------

             [C]     +--------+   [RFCE]
           --------> | editor | <--------
          /          +--------+          \
         /         [RFCE]^                \
        /                |                 \
     +-------+ [sjbB]+---------+  [RET] +---------+
     | main  | <---> | headers | <----> | message |
     +-------+  [q]  +---------+ [qbBjs]+---------+
                       [sjbB]                ^
                                         [.] | [q]
                                             V
                                           +-----+
                                           | raw |
                                           +-----+

     Default bindings
     ----------------
     R: Reply      s: search            .: raw view (toggle)
     F: Forward    j: jump-to-maildir   q: quit
     C: Compose    b: bookmark-search
     E: Edit       B: bookmark-search (edit-first)

     ----------------------------------------------------------------------------


File: mu4e.info,  Node: Main view,  Next: Headers view,  Up: Running mu4e

3.1 Main view
=============

After you have installed mu4e (*note Getting started::), you can start
it with `M-x mu4e'. This will do some checks to ensure everything is
set up correctly, and then show the mu4e main view.

   This looks something like the following:

----------------------------------------------------------------------------
* mu4e - mu for emacs version x.x

  Basics

	* [j]ump to some maildir
	* enter a [s]earch query
	* [C]ompose a new message

  Bookmarks

	* [bu] Unread messages
	* [bt] Today's messages
	* [bw] Last 7 days
	* [bp] Messages with images
  Misc

	* [U]pdate email & database
	* toggle [m]ail sending mode (direct)
	* [f]lush queued mail

        * [H]elp
	* [q]uit mu4e
----------------------------------------------------------------------------

   In the below, we assume the default key bindings here. If you've
changed those, well, mutatis mutandis.

3.1.1 Basic actions
-------------------

First, the _Basics_:
   * [j]ump to some maildir means that after pressing <j>, mu4e will
     ask you for a maildir to jump to. These are the maildirs you set
     in *note Basic configuration::.

   * enter a [s]earch query means that after pressing <s> you will be
     asked for a search query, and after entering one, the results will
     be shown. *Note Searching mail::.

   * [C]ompose a new message means that after pressing <C>, you will be
     thrown in a message-editing buffer, where you can compose a new
     message.

3.1.2 Bookmarks
---------------

Next come the _Bookmarks_.These are set with the variable
`mu4e-bookmarks'; what you see in the above example are the _default_
bookmarks - you can add your own and/or replace the default ones. *Note
Bookmarks::. In short, you can view the list of messages matching a
bookmark by pressing <b> followed by the shortcut for this bookmark. If
you'd like to edit the bookmarked query first, use <B>.

3.1.3 Miscellaneous
-------------------

Finally, there are some _Misc_ actions:
   * [U]pdate email & database will execute whatever is in the variable
     `mu4e-get-mail-command', and afterwards update the mu database;
     *note Indexing your messages::. See *note Getting mail:: for
     details.

   * toggle [m]ail sending mode (direct) will toggle between sending
     mail directly, and queuing it first (for example, when you are
     offline), and [f]lush queued mail will flush any queued mail. This
     item is visible only if you have actually set up mail-queuing.
     *Note Queuing mail::.

   * [H]elp will show help information for this view.

   * Finally, [q]uit mu4e will quit mu4e.


File: mu4e.info,  Node: Headers view,  Next: Message view,  Prev: Main view,  Up: Running mu4e

3.2 Headers view
================

The headers view shows the results of search queries. There is a line
for each matching message, each showing a number of fields describing
the corresponding message.

   This looks something like the following:

----------------------------------------------------------------------------------
  Date              Flgs   From/To             Subject
  2011-12-16 18:38  uN     To Edmund Dantès    + Re: Extension security?
  2011-12-16 21:44  uN     Abbé Busoni             + Re: Extension security?
  2011-12-17 03:14  uN     Pierre Morrel           + Re: Extension security?
  2011-12-17 04:04  uN     Jacopo                    + Re: Extension security?
  2011-12-17 14:36  uN     Mercédès                    + Re: Extension security?
  2011-12-18 06:05  uN     Beachamp                      \ Re: Extension security?
  2011-12-16 18:23  uN     Albert de Moncerf   + Re: [O] A presentation tool
  2011-12-17 01:53  usaN   Gaspard Caderousse    \ Re: [O] A presentation tool
  2011-12-16 16:31  uN     Baron Danglars      | [O] imaxima?
End of search results
----------------------------------------------------------------------------------

3.2.1 Some notes
----------------

Some notes to explain what you see in the example:

   * The fields shown in the headers view can be influenced by
     customizing the variable mu4e-headers-fields

   * You can change the date format by customizing
     mu4e-headers-date-format

   * The letters in the 'Flags' field correspond to the following:
     D=draft, F=flagged, N=new, P=passed (i.e.., forwarded), R=replied,
     S=seen, T=trashed, a=has-attachment, x=encrypted, s=signed,
     u=unread.

   * The From/To field shows the sender of the message unless the sender
     matches the regular expression in mu4e-user-mail-address-regexp, in
     which the header will show To followed by the recipient.

   * The subject field displays the discussion threads according to the
     _JWZ mail threading algorithm_(1).

3.2.2 Keybindings
-----------------

Using the default key bindings, you can do various things with these
messages; these actions are also listed in the Headers menu in the
Emacs menu bar.

key          description
---          -----------
n,p          go to next, previous message

j            jump to maildir
b,B          jump to bookmark (/ edit first)

d            mark for moving to the trash folder
DEL,D        mark for immediate deletion
m            mark for moving to another maildir folder
u            unmark message at point
R,F,C        reply/forward/compose
E            edit (only allowed for draft messages)

d            mark for moving to the trash folder
DEL,D        mark for immediate deletion
m            mark for moving to another maildir folder
o            mark message as unread
r            mark message as read
u            unmark message at point
U            unmark *all* messages
x            execute actions for the marked messages
RET          open the message at point in the message view
H            get help
q            leave the headers buffer

3.2.3 Some notes on marking
---------------------------

Note, all mark/unmark commands support the current _region_ (i.e.,
selection) - so, for example, if you the select a number of message and
then press <DEL>, all selected message will be marked for deletion.

   The two-step mark-execute sequence is similar to what dired and a
number of other emacs-based programs do. mu4e tries to be as quick as
possible while still trying to protect you from accidents.

   When you try to do a new search, or refresh the headers buffer while
you still have marked messages, normally you will be asked what to do
with those marks - whether to _apply_ them before leaving, _ignore_
them or to _cancel_ the operation. This behavior can be influenced with
the variable ``mu4e-headers-leave-behavior'' - see its documentation.

   ---------- Footnotes ----------

   (1) `http://www.jwz.org/doc/threading.html'


File: mu4e.info,  Node: Message view,  Next: Editor view,  Prev: Headers view,  Up: Running mu4e

3.3 Message view
================

After selecting a message in the *note Headers view::, it will be shown
in the message view, for example:

----------------------------------------------------------------------------
From: info@galatians.net
To: "Paul" paul@hotmail.com
Subject: Re: some thoughts
Flags: (seen attach)
Date: Mon 19 Jan 2004 09:39:42 AM EET
Maildir: /inbox
Attachments(2): [1]DSCN4961.JPG(1.3M), [2]DSCN4962.JPG(1.4M)

Hi Paul,

How are you? Sorry we didn't get back to you sooner and sorry for the
top-quoting. We're still debating your last message; anyway, here are some
recent pics. And here's a link: http://example.com[1]

All the best!

On Sun 21 Dec 2003 09:06:34 PM EET, Paul wrote:

[....]
----------------------------------------------------------------------------

   Some notes:
   * You can determine which header fields are shown by setting the
     variable `mu4e-view-fields'.

   * You can customize the date format by setting the variable
     `mu4e-date-format-long', using the same format that
     `format-time-string' uses.

   * The body text can be line-wrapped (toggle between
     wrapped/not-wrapped with <w>) and/or cited parts can be hidden
     (toggle between hidden/not-hidden with <h>. If you want to do this
     by default when viewing messages, you can set, respectively,
     `mu4e-view-wrap-lines' and `mu4e-view-hide-cited' to `t'. (1)


3.3.1 Keybindings
-----------------

You can find most things you can do with this message in the _View_
menu, or by using the keyboard; the default bindings are:

key          description
---          -----------
n,p          go to next, previous message

j            jump to maildir
b,B          jump to bookmark (/ edit first)

d            mark for moving to the trash folder
DEL,D        mark for immediate deletion
m            mark for moving to another maildir folder
u            unmark message at point
R,F,C        reply/forward/compose
E            edit (only allowed for draft messages)

.            show the raw message view. ./q take you back
|            pipe the message through a shell command

g            go to (visit) numbered URL (using `browse-url')
             (or: <mouse-2> or RET with point on url)
e            extract (save) attachment (asks for number)
             (or: <mouse-2> or RET with point on attachment)
o            open attachment (asks for number)
             (or: <S-mouse-2> or S-RET with point on attachment)
w            toggle line wrapping
h            toggle showing cited parts

H            get help
q            leave the headers buffer

   Note that <x>, which means 'execute actions on marked messages' is
not available in this view, to reduce the risk of accidents. You need
to go back to the headers view to effectuate the actions.

3.3.2 Attachments
-----------------

By default, the attachment is opened using either the xdg-open-program
(2) or (on MacOS) the qopen program. If you want to use another
program, you specify this by setting the MU_PLAY_PROGRAM environment
variable.

   When extracting (saving) attachments (with <e>), the default
directory for saving them is your home directory (`~/'); you can change
this using the variable `mu4e-attachment-dir', for example:

     (setq mu4e-attachment-dir (file-name-expand "~/Downloads"))

3.3.3 Displaying messages
-------------------------

For displaying messages, mu4e normally prefers the plain-text version
for messages consisting of both a plain-text and an html (rich-text)
version of its body-text. If there is only an html-version, or if the
plaint-text version is too short in comparison with the html part, mu4e
tries to convert the html into plain-text for display. The default way
to do that is to use the Emacs built-in `html2text' function, but if
you set the variable `mu4e-html2text-command' to some external program,
that program will be used. This program is expected to take html from
standard input and write plain text in utf-8 encoding on standard
output.

   An obvious choice for this is the program that is actually _called_
html2text(3), which you could set up with something like the following
in your initialization files:

     (setq mu4e-html2text-command "html2text -utf8 -width 72")

   Normally, mu4e prefers the text-version of an e-mail message to
determine the message body. You can change this by setting
`mu4e-view-prefer-html'.

   ---------- Footnotes ----------

   (1) If you have installed the filladapt package
(`http://www.wonderworks.com/download/filladapt.el'), mu4e will use it
for line-wrapping, as it generally does a better job than the default
mechanism emacs provides.

   (2) `http://portland.freedesktop.org/wiki/'

   (3) `http://www.mbayer.de/html2text/'


File: mu4e.info,  Node: Editor view,  Prev: Message view,  Up: Running mu4e

3.4 Editor view
===============

For its editor, mu4e re-uses Gnu's message-mode. For example, when
replying to a message, the editor view looks something like the
following:

----------------------------------------------------------------------------
From: Rupert the Monkey <rupert@example.com>
Reply-To: rupert@example.com
To: Wally the Walrus <wally@example.com>
In-reply-to: <201201160918.47080.ssdfz@example.com>
Subject: Re: Eau-qui d'eau qui?
--text follows this line--

On Mon 16 Jan 2012 10:18:47 AM EET, Wally the Walrus wrote:

 > Hi Rupert,
 >
 > Dude - how are things?
 >
 > Later -- wally.
----------------------------------------------------------------------------

   Since mu4e uses Gnu's message editor, for documentation *note
()Message::. Also, *note Sending mail::. There are many key-bindings
available, here are some of the essential ones (you can use the menu to
find more):

3.4.1 Some useful keybindings
-----------------------------

key          description
---          -----------
C-c C-c      send message
C-c C-d      save to drafts and leave
C-c C-k      kill the message
C-c C-w      insert signature
C-c C-a      attach a file (pro-tip: drag & drop works as well)


File: mu4e.info,  Node: Searching mail,  Next: Interaction with other tools,  Prev: Running mu4e,  Up: Top

4 Searching mail
****************

mu4e is fully search-based; this means that all the lists of messages
you see, are the result of some query. Even if you 'jump to a folder',
in fact you are executing a search query for messages that happen to
have the property of being in a certain folder.

   Queries normally return only up to `mu4e-search-results-limit' (which
defaults to 500) results. You get _all_ results when you prefix your
search commands (such as with `mu4e-search', `mu4e-search-bookmark',
`mu4e-search-bookmark-edit-first' and `mu4e-jump-to-maildir' with `C-u'.

   The reason for limiting the number of results in the query is that
emacs may become a bit slow when displaying many results, and in many
cases `mu4e-search-results-limit' should be enough.

* Menu:

* Queries::
* Bookmarks::
* Maildir searches::


File: mu4e.info,  Node: Queries,  Next: Bookmarks,  Up: Searching mail

4.1 Queries
===========

The queries you can execute are the same ones that `mu find'
understands. Please refer to the `mu-find' and `mu-easy' man pages for
details and more examples.

# get all messages about bananas
bananas

# get all messages about bananas from john with an attachment
from:john flag:attach bananas

# get all messages with subject wombat in June 2009
subject:wombat date:20090601..20090630

# get all messages with PDF attachments in the /projects folder
maildir:/projects mime:application/pdf

# get all important messages which are signed:
flag:signed prio:high

# get all messages from Jim without an attachment:
from:jim AND NOT flag:attach

# get all unread messages where the subject mentions Ångström:
subject:angstrom flag:unread

# get all unread messages between Mar-2002 and Aug-2003 about some bird
date:20020301..20030831 nightingale flag:unread

# get today's messages
date:today..now

# get all messages we got in the last two weeks regarding emacs
date:2w..now emacs

# get mails with a subject soccer, Socrates, society...
# note: the '*' wildcard can only appear as the rightmost character in the term
subject:soc*

# get all mails with attachment with filenames starting with 'pic'
# note: the '*' wildcard can only appear as the rightmost character in the term
file:pic*

# get all messages with PDF attachments:
mime:application/pdf

# get all messages with image attachments:
# note: the '*' wildcard can only appear as the rightmost character in the term
mime:image/*


File: mu4e.info,  Node: Bookmarks,  Next: Maildir searches,  Prev: Queries,  Up: Searching mail

4.2 Bookmarks
=============

If you have queries that you use often, you may want to store them as
_bookmarks_. These bookmarks then show up in the main view, and you can
invoke them in other places as well. Bookmark searches are available in
the main view *note Main view::, header view *Note Headers view::, and
message view *Note Message view::, using (by default) the key <b>
(`mu4e-search-bookmark').

4.2.1 Setting up bookmarks
--------------------------

`mu4e' provides some default bookmarks, which you can override. The
definition of the default bookmarks is instructive here:

     (defvar mu4e-bookmarks
       '( ("flag:unread AND NOT flag:trashed" "Unread messages"      ?u)
          ("date:today..now"                  "Today's messages"     ?t)
          ("date:7d..now"                     "Last 7 days"          ?w)
          ("mime:image/*"                     "Messages with images" ?p))
       "A list of pre-defined queries; these will show up in the main
     screen. Each of the list elements is a three-element list of the
     form (QUERY DESCRIPTION KEY), where QUERY is a string with a mu
     query, DESCRIPTION is a short description of the query (this will
     show up in the UI), and KEY is a shortcut key for the query.")

   You can replaces these, or add your own items, by putting in your
configuration (`~/.emacs') something like:
     (add-to-list 'mu4e-bookmarks
       '("size:5M..500M"       "Big messages"     ?b))

   This prepends your bookmark to the list, and assigns the key <b> to
it. If you want to _append_ your bookmark, you can use `t' as the third
argument to `add-to-list'.

   In the various mu4e views, pressing <b> will list all the bookmarks
defined in the echo area, with the shortcut key highlighted. So, to
invoke the bookmark we just defined (to get the list of "Big
Messages"), all you need to type is <bb>.

4.2.2 Editing bookmarks before searching
----------------------------------------

There is also `mu4e-search-bookmark-edit-first' (key <B>), which lets
you edit the search query with some bookmark already filled in. This
can be useful if you have many similar queries, but need to change some
parameter. For example, you could have a bookmark "NOT maildir:/Trash
AND"(1) and add whatever you want to search for to that. Or, to do a
query limited to the messages of today, all you need to type is <Bt>
(using the Today's messages-bookmark, see above).

   ---------- Footnotes ----------

   (1) Not a valid search query by itself


File: mu4e.info,  Node: Maildir searches,  Prev: Bookmarks,  Up: Searching mail

4.3 Maildir searches
====================

Maildir searches are quite similar to bookmark searches (see *note
Bookmarks::), with the difference being that the target is always a
maildir - maildir queries provide a 'traditional' folder-like interface
to a search-based e-mail client. By default, maildir searches are
available in the *note Main view::, *note Headers view::, and *note
Message view::, with the key <j> (`mu4e-jump-to-maildir').

4.3.1 Setting up maildir shortcuts
----------------------------------

You can do Maildir searches manually (e.g. with a query like
`maildir:/myfolder') but since it is so common, mu4e offers a quicker
way to do this.

   To enable this, you need to set the variable mu4e-maildir-shortcuts
to list of maildirs you'd like to have quick access to, for example:

        (setq mu4e-maildir-shortcuts
         '( ("/inbox"     . ?i)
            ("/archive"   . ?a)
            ("/lists"     . ?l)
            ("/work"      . ?w)
            ("/sent"      . ?s))

   This would set <i> as a shortcut for the /inbox folder; so
effectively a query maildir:/inbox. There is a special shortcut <o> for
_other_ (so don't use that one for your own shortcuts!), which allows
you to choose from _all_ maildirs.

   Each of the folder names is relative to your top-level maildir
directory; so if you keep your mail in `~/Maildir', `/inbox' would
refer to `~/Maildir/inbox'.

   Having these shortcuts allows you to jump around your folder very
quickly - for example, getting to the /lists folder only requires you
to type <jl>.

   The very same shortcuts are used by the `mu4e-mark-for-move' (default
shortcut <m>); so, for example, if you want to move a message the
/archive folder, you can do so by typing <ma>.


File: mu4e.info,  Node: Interaction with other tools,  Next: Example configuration,  Prev: Searching mail,  Up: Top

5 Interaction with other tools
******************************

In this chapter we discuss some ways in ways in which mu4e can cooperate
with other tools.

* Menu:

* Creating org-mode links::
* Maintaining an address-book with org-contacts::
* Getting new mail notifications with Sauron::
* Speedbar support::


File: mu4e.info,  Node: Creating org-mode links,  Next: Maintaining an address-book with org-contacts,  Up: Interaction with other tools

5.1 Creating org-mode links
===========================

It can be useful to include links to e-mail messages or even search
queries in your org-mode files. mu4e supports this with the org-mu4e
module; you can set it up by adding it to your configuration:

     (require 'org-mu4e)

   After this, you can use the normal org-mode mechanisms to store
links: M-x org-store-link will store a link to a particular message
when you're in Message view (*note Message view::), and a link to a
query when you are in Headers view (*note Headers view::). You can
insert these link later with M-x org-insert-link. Then, you can go to
the query or message the link points to with either M-x
org-agenda-open-link in agenda buffers, or M-x org-open-at-point
elsewhere - both are typically bound to `C-c C-o'.


File: mu4e.info,  Node: Maintaining an address-book with org-contacts,  Next: Getting new mail notifications with Sauron,  Prev: Creating org-mode links,  Up: Interaction with other tools

5.2 Maintaining an address-book with org-contacts
=================================================

To manage your addresses using org-mode, there is org-contacts(1).

   You can use it with a capture-template:
("c" "contacts" entry (file "contacts.org")
"* %(mu4e-view-snarf-from 'name)
:PROPERTIES:
:EMAIL: %(mu4e-view-snarf-from 'email)
:NICK:
:BIRTHDAY:
:END:\n\n")

   After setting this up, you can use M-x org-capture RET c to get a
template for a new contact based on` the 'From:' address.

   ---------- Footnotes ----------

   (1) `http://julien.danjou.info/software/org-contacts.el'


File: mu4e.info,  Node: Getting new mail notifications with Sauron,  Next: Speedbar support,  Prev: Maintaining an address-book with org-contacts,  Up: Interaction with other tools

5.3 Getting new mail notifications with Sauron
==============================================

The emacs-package Sauron(1) (by the same author) can be used to get
notifications about new mails.

   If you put something like the below script in your crontab (or have
some other way of having it execute every _n_ minutes, you will receive
notifications in the sauron-buffer when new messages arrive.

#!/bin/sh
# put the path to your Inbox folder here

CHECKDIR="/home/$LOGNAME/Maildir/Inbox"
sauron-msg () {
    DBUS_COOKIE="/home/$LOGNAME/.sauron-dbus"
    if test "x$DBUS_SESSION_BUS_ADDRESS" = "x"; then
        if test -e $DBUS_COOKIE; then
                export DBUS_SESSION_BUS_ADDRESS="`cat $DBUS_COOKIE`"
        fi
    fi
    if test -n "x$DBUS_SESSION_BUS_ADDRESS"; then
        dbus-send --session                 \
            --dest="org.gnu.Emacs"        \
            "/org/gnu/Emacs/Sauron"                \
            "org.gnu.Emacs.Sauron.AddMsgEvent"      \
            string:shell uint32:3 string:"$1"
    fi
}

for f in `find $CHECKDIR -mmin -2 -a -type f`; do
        subject=`$MU view $f | grep '^Subject:' | sed 's/^Subject://'`
        sauron-msg "mail: $subject"
done

   Note, you should put something like:
     (setq sauron-dbus-cookie t)
   in your setup, which allows the script to find the D-Bus session bus.

   ---------- Footnotes ----------

   (1) Sauron can be found at `https://github.com/djcb/sauron', or in
the Marmalade package-repository at `http://http://marmalade-repo.org/'.


File: mu4e.info,  Node: Speedbar support,  Prev: Getting new mail notifications with Sauron,  Up: Interaction with other tools

5.4 Speedbar support
====================

`speedbar' is an emacs-extension that shows navigational information for
an emacs buffer in a separate frame. Using `mu4e-speedbar', mu4e lists
your bookmarks and maildir folders and allows for one-click access to
them.

   mu4e loads mu4e-speedbar automatically; all you need to do to
activate it is `M-x speedbar'. Then, when then going to the *note Main
view::, the speedbar-frame will be updated with your bookmarks and
maildirs.

   `mu4e-speedbar' was contributed by Antono Vasiljev.


File: mu4e.info,  Node: Example configuration,  Next: FAQ - Frequently Anticipated Questions,  Prev: Interaction with other tools,  Up: Top

6 Example configuration
***********************

In this chapter, we show some example configurations.

* Menu:

* Minimal configuration::
* Longer configuration::
* Gmail configuration::


File: mu4e.info,  Node: Minimal configuration,  Next: Longer configuration,  Up: Example configuration

6.1 Minimal configuration
=========================

An (almost) minimal configuration for mu4e might look something like
this:

     ;; example configuration for mu-for-emacs (mu4e)
     (require 'mu4e)

     ;; happily, below settings are all /optional/

     ;; Only needed if your maildir is _not_ ~/Maildir
     ;;(setq mu4e-maildir "/home/user/Maildir")

     ;; these must start with a "/", and must exist
     ;; (i.e.. /home/user/Maildir/sent must exist)
     ;; you use e.g. 'mu mkdir' to make the Maildirs if they don't
     ;; already exist

     ;; below are the defaults; if they do not exist yet, mu4e will offer to
     ;; create them
     ;; (setq mu4e-sent-folder   "/sent")
     ;; (setq mu4e-drafts-folder "/drafts")
     ;; (setq mu4e-trash-folder  "/trash")

     ;; for the settings for outgoing mail consult the section 'Longer configuration'


File: mu4e.info,  Node: Longer configuration,  Next: Gmail configuration,  Prev: Minimal configuration,  Up: Example configuration

6.2 Longer configuration
========================

     ;; example configuration for mu-for-emacs (mu4e)
     (require 'mu4e)

     (setq
        ;; a regular expression that matches all email address uses by the user;
        ;; this allows us to correctly determine if user is the sender of some message
        mu4e-user-mail-address-regexp
           "foo@bar\.com\\|cuux@example\.com"

        ;; path to our Maildir directory
        mu4e-maildir       "/home/user/Maildir"
        ;; the next are relative to `mu4e-maildir'
        mu4e-sent-folder   "/sent"
        mu4e-drafts-folder "/drafts"
        mu4e-trash-folder  "/trash"

        ;; the maildirs you use frequently; access them with 'j' ('jump')
        mu4e-maildir-shortcuts
         '( ("/archive"     . ?a)
            ("/inbox"       . ?i)
            ("/work"        . ?w)
            ("/sent"        . ?s))

        ;; when you want to use some external command for text->html conversion,
        ;; i.e., the 'html2text' program
        mu4e-html2text-command "html2text"

        ;; the headers to show in the headers list -- a pair of the field + its
        ;; width, with `nil' meaning 'unlimited' (better only use that for
        ;; the last field. These are the defaults:
        mu4e-headers-fields
         '( (:date          .  25)
            (:flags         .   6)
            (:from          .  22)
            (:subject       .  nil))

        ;; program to get mail; alternatives are 'fetchmail', 'getmail'
        ;; isync or your own shellscript. called when 'U' is pressed in
        ;; main view
        mu4e-get-mail-command "offlineimap"

        ;; general emacs mail settings; used when composing e-mail
        mail-reply-to "foo@bar.com"
        user-mail-address "foo@bar.com"
        user-full-name  "Foo X. Bar"

        ;; include in message with C-c C-w
        message-signature
         (concat
           "Foo X. Bar\n"
           "http://www.example.com\n")

        ;; smtp mail setting
        message-send-mail-function 'smtpmail-send-it
        smtpmail-default-smtp-server "smtp.example.com"
        smtpmail-smtp-server ""smtp.example.com"
        smtpmail-local-domain "example.com"

        ;; if you need offline mode, set these -- and create the queue dir
        ;; with 'mu mkdir', i.e.. mu mkdir /home/user/Maildir/queue
        smtpmail-queue-mail  nil
        smtpmail-queue-dir   "/home/user/Maildir/queue/cur")


File: mu4e.info,  Node: Gmail configuration,  Prev: Longer configuration,  Up: Example configuration

6.3 Gmail configuration
=======================

_Gmail_ is a popular e-mail provider; let's see how we can make it work
with mu4e.

   First of all, we need a program to get the e-mail from Gmail on our
local machine; for this we use offlineimap; on Debian (and derivatives
like Ubuntu), this is as easy as:
sudo apt-get install offlineimap

   Then, create a configuration for offlineimap, i.e. a file
`~/.offlineimaprc':

[general]
accounts = Gmail
maxsyncaccounts = 3

[Account Gmail]
localrepository = Local
remoterepository = Remote

[Repository Local]
type = Maildir
localfolders = ~/Maildir

[Repository Remote]
type = IMAP
remotehost = imap.gmail.com
remoteuser = USERNAME@gmail.com
remotepass = PASSWORD
ssl = yes
maxconnections = 1
realdelete = no

   Of course, you need replace USERNAME and PASSWORD with your actual
GMail username and password.

   After this, you should be able to download your mail:
$ offlineimap
 OfflineIMAP 6.3.4
Copyright 2002-2011 John Goerzen & contributors.
Licensed under the GNU GPL v2+ (v2 or any later version).

Account sync Gmail:
 ***** Processing account Gmail
 Copying folder structure from IMAP to Maildir
 Establishing connection to imap.gmail.com:993.
Folder sync [Gmail]:
 Syncing INBOX: IMAP -> Maildir
 Syncing [Gmail]/All Mail: IMAP -> Maildir
 Syncing [Gmail]/Drafts: IMAP -> Maildir
 Syncing [Gmail]/Sent Mail: IMAP -> Maildir
 Syncing [Gmail]/Spam: IMAP -> Maildir
 Syncing [Gmail]/Starred: IMAP -> Maildir
 Syncing [Gmail]/Trash: IMAP -> Maildir
Account sync Gmail:
 ***** Finished processing account Gmail

   We can now run mu to make sure things work:

$ mu index
mu: indexing messages under /home/foo/Maildir [/home/foo/.mu/xapian]
| processing mail; processed: 520; updated/new: 520, cleaned-up: 0
mu: elapsed: 3 second(s), ~ 173 msg/s
mu: cleaning up messages [/home/foo/.mu/xapian]
/ processing mail; processed: 520; updated/new: 0, cleaned-up: 0
mu: elapsed: 0 second(s)

   Note that we can run both the offlineimap and the mu index from
within mu4e, but running it from the command line makes it a bit easier
to see what is going on.

   Now, let's make a mu4e configuration for this:

     (require 'mu4e)

     ;; default
     ;; (setq mu4e-maildir (expand-file-name "~/Maildir"))

     (setq mu4e-drafts-folder "/[Gmail].Drafts")
     (setq mu4e-sent-folder   "/[Gmail].Sent Mail")
     (setq mu4e-trash-folder  "/[Gmail].Trash")

     ;; don't save message to Sent Messages, GMail/IMAP will take care of this
     (setq mu4e-sent-messages-behavior 'delete)

     ;; setup some handy shortcuts
     (setq mu4e-maildir-shortcuts
         '( ("/INBOX"               . ?i)
            ("/[Gmail].Sent Mail"   . ?s)
            ("/[Gmail].Trash"       . ?t)
            ("/[Gmail].All Mail"    . ?a)))

     ;; allow for updating mail using 'U' in the main view:
     (setq mu4e-get-mail-command "offlineimap")

     ;; something about ourselves
     (setq
        user-mail-address "USERNAME@gmail.com"
        user-full-name  "Foo X. Bar"

        ;; include in message with C-c C-w
        message-signature
         (concat
           "Foo X. Bar\n"
           "http://www.example.com\n"))

     ;; sending mail -- replace USERNAME with your gmail username
     ;; also, make sure the gnutls command line utils are installed
     ;; package 'gnutls-bin' in Debian/Ubuntu

     (require 'smtpmail)
     (setq message-send-mail-function 'smtpmail-send-it
           starttls-use-gnutls t
           smtpmail-starttls-credentials '(("smtp.gmail.com" 587 nil nil))
           smtpmail-auth-credentials '(("smtp.gmail.com" 587 "USERNAME@gmail.com" nil))
           smtpmail-default-smtp-server "smtp.gmail.com"
           smtpmail-smtp-server "smtp.gmail.com"
           smtpmail-smtp-service 587)

   And that's it - put the above in your `~/.emacs' (obviously you need
to change USERNAME etc. to your own), and restart emacs, and run `M-x
mu4e'.

   Using these setting you can quickly switch to your Inbox - press
`ji'. Then, when you want archive some messages, move them to the 'All
Mail' folder by pressing `ma'.


File: mu4e.info,  Node: FAQ - Frequently Anticipated Questions,  Next: Known issues / missing features,  Prev: Example configuration,  Up: Top

7 FAQ - Frequently Anticipated Questions
****************************************

In this chapter we list a number of actual and anticipated questions
and their answers.

   * _How can I quickly delete/move/trash a lot of messages?_ You can
     select ('mark' in emacs-speak) the messages; the actions you then
     take (e.g., <DEL> for delete, <m> for move and <t> for trash) will
     apply to _all_ selected messages

   * _How can I use BBDB?_ Currently, there is no built-in for address
     management with BBDB; instead, we recommend *note Maintaining an
     address-book with org-contacts:: for now.

   * _mu4e only seems to return a subset of all matches - how can I get
     all?_. Yes, for speed reasons (and because, if you are like the
     author, you usually don't need thousands of matches), mu4e returns
     only up to the value of the variable `m4ue-search-result-limit'
     matches. You can customize that variable, or simply press the
     emacs prefix `C-u' before your search command to get all matches.
     In other words, when you press C-u s hello you will get all
     matches, while s hello only gets you up-to-a-limited-number
     matches. Same for the other search based commands,
     `mu4e-jump-to-maildir' (default: <j>) and `mu4e-search-bookmark'
     (default: <b>).

   * _How can I easily include attachments in the messages I write?_
     Drag-and-drop.

   * _When I try do run mu index while mu4e is running I get errors
     like mu: mu_store_new_writable: xapian error 'Unable to get write
     lock on ~/.mu/xapian: already locked'. What can I do about this?_
     You get this error because the underlying Xapian database allows
     itself to be opened in read-write mode only once. There is not
     much mu4e can do about this, but what you can do is telling mu to
     (gracefully) terminate:    pkill -2 -u $UID mu # send SIGINT
        sleep 1
        mu index
      mu4e will automatically restart mu when it needs it. In practice,
     this seems to work quite well.

   * _Can I automatically execute the actions on marked messages when
     leaving the headers buffer?_ Yes you can - see the documentation on
     mu4e-headers-leave-behavior.

   * _Can I automatically apply word-wrapping (and hiding cited parts)
     when viewing a message?_ Yes - see the documentation on
     mu4e-view-wrap-lines (and mu4e-view-hide-cited). You can always
     toggle between the two states with <w> and <h>, respectively.

   * _Is there context-sensitive help available?_ Yes - pressing <H> in
     most cases should point you to the right spot in this manual.



File: mu4e.info,  Node: Known issues / missing features,  Next: How it works,  Prev: FAQ - Frequently Anticipated Questions,  Up: Top

8 Known issues / missing features
*********************************

In this chapter we list a number of known issue and/or missing features
in mu4e. Thus, users won't have to search in vain for things that are
not there (yet), and the author can use it as a todo-list.

   * _Thread handling is incomplete._ While threads are calculated and
     are visible in the headers buffer, there is no functionality to
     manipulate them (e.g., collapse the thread, or delete a whole
     thread at once). But note that you can manipulate a number of
     consecutive messages at once by selecting them, and then using one
     of the manipulation commands, such as `mu4e-mark-for-move' or
     `mu4e-mark-for-delete'.

   * _No support for crypto when reading mail_. Currently, you cannot
     conveniently read encrypted mail or check signatures (it should be
     possible with e.g. EPA though, *note EasyPG Assistant: (epa)Top.)
     For outgoing messages, it should work though, using the built-in
     mechanisms.

   * _One cannot influence the sorting of messages_. Messages are sorted
     according to thread, then descending by date. It would be nice if
     it could be sorted in other ways as well.

   * _The key-bindings are _somewhat_ hard-coded_ That is, the main
     menu assumes the default key-bindings, as do the
     clicks-on-bookmarks.

   * _Attachments are not accessible in draft/sent messages_. Currently,
     attachments in saved messages are special strings, which are
     transformed into the actual attachments when sending. However, you
     cannot access them afterwards.



File: mu4e.info,  Node: How it works,  Next: GNU Free Documentation License,  Prev: Known issues / missing features,  Up: Top

Appendix A How it works
***********************

While not necessarily interesting for all users of mu4e, for some it may
be interesting to know how mu4e does its job.

* Menu:

* High-level overview::
* mu server::
* Reading from the server::


File: mu4e.info,  Node: High-level overview,  Next: mu server,  Up: How it works

A.1 High-level overview
=======================

On a high level, we can summarize the structure of the mu4e system using
some ascii-art:

                   +---------+
                   | emacs   |
                   |    +------+
                   +----| mu4e | --> send mail (smtpmail)
                        +------+
                         |  A
                         V  |  ---/ search, view, move mail
                   +---------+    \
                   |   mu    |
                   +---------+
                     |    A
                     V    |
                   +---------+
                   | Maildir |  <--- receive mail (fetchmail,
                   +---------+                     offlineimap, ...)

   In words:
   * Your e-mail messages are stored in a Maildir-directory (typically,
     `~/Maildir'), and new mail comes in using tools like fetchmail,
     offlineimap, or through a local mail servers (such as qmail or
     Postfix).

   * mu indexes these messages periodically, so you can quickly  search
     for them. mu can run in a special server-mode, where it  provides
     services to client software.

   * mu4e, which runs inside emacs is such a client; it communicates
     with mu (in its server-mode to search for messages, and manipulate
     them.

   * mu4e uses the facilities offered by emacs (the  Gnus message
     editor and smtpmail) to send messages.



File: mu4e.info,  Node: mu server,  Next: Reading from the server,  Prev: High-level overview,  Up: How it works

A.2 mu server
=============

mu4e is based on the mu e-mail searching/indexer. The latter is a
C-program; there are different ways to communicate with a client that is
emacs-based.

   One way to implement this, would be to call the mu command-line tool
with some parameters and then parse the output. In fact, that is how
some tools do it, and it was the first approach - mu4e would invoke
e.g., mu find and process the output in emacs.

   However, with approach, we need to load the entire e-mail _Xapian_
database (in which the message is stored) for each invocation. Wouldn't
it be nicer to keep a running mu instance around?  Indeed, it would -
and thus, the mu server sub-command was born. Running mu server, you
get a sort-of shell, in which you can give commands to mu, which will
then spit out the results/errors. mu server is not meant for humans,
but it can be used manually, which is great for debugging.


File: mu4e.info,  Node: Reading from the server,  Prev: mu server,  Up: How it works

A.3 Reading from the server
===========================

In the design, the next question was what format mu should use for its
output for mu4e (emacs) to process. Some other programs use JSON here,
but it seemed easier (and possibly, more efficient) just to talk to
emacs in its native language: _s-expressions_ (to be precise:
_plists_), and interpret those using the emacs-function
`read-from-string'.

   So, now let's look how we process the data from mu server in emacs.
We'll leave out a lot of detail, mu4e-specifics, and look at a bit more
generic approach.

   The first is to create a process with, for example, `start-process',
and then register a filter function for it, which will be invoked
whenever the process has some chunk of output. Something like:

       (let ((proc (start-process <arguments>)))
         (set-process-filter proc 'my-process-filter)
         (set-process-sentinel proc 'my-process-sentinel))

   Note, the process sentinel is invoked when the process is terminated
- so there you can clean things up.

   The function =my-process-filter= is a user-defined function that
takes the process and the chunk of output as arguments; in mu4e it
looks something like (pseudo-lisp):

     (defun my-process-filter (proc str)
       ;; mu4e-buf: a global string variable to which data gets appended
       ;; as we receive it
       (setq mu4e-buf (concat mu4e-buf str))
       (when <we-have-received-a-full-expression>
           <eat-expression-from mu4e-buf>
           <evaluate-expression>))

   `<evaluate-expression>' de-multiplexes the s-expression we got. For
example, if the s-expression looks like an e-mail message header, it
will be processed by the header-handling function, which will append it
to the header list. If the s-expression looks like an error message, it
will be reported to the user. And so on.


File: mu4e.info,  Node: GNU Free Documentation License,  Prev: How it works,  Up: Top

Appendix B GNU Free Documentation License
*****************************************

                      Version 1.2, November 2002

     Copyright (C) 2000,2001,2002 Free Software Foundation, Inc.
     51 Franklin St, Fifth Floor, Boston, MA  02110-1301, USA

     Everyone is permitted to copy and distribute verbatim copies
     of this license document, but changing it is not allowed.

  0. PREAMBLE

     The purpose of this License is to make a manual, textbook, or other
     functional and useful document "free" in the sense of freedom: to
     assure everyone the effective freedom to copy and redistribute it,
     with or without modifying it, either commercially or
     noncommercially.  Secondarily, this License preserves for the
     author and publisher a way to get credit for their work, while not
     being considered responsible for modifications made by others.

     This License is a kind of "copyleft", which means that derivative
     works of the document must themselves be free in the same sense.
     It complements the GNU General Public License, which is a copyleft
     license designed for free software.

     We have designed this License in order to use it for manuals for
     free software, because free software needs free documentation: a
     free program should come with manuals providing the same freedoms
     that the software does.  But this License is not limited to
     software manuals; it can be used for any textual work, regardless
     of subject matter or whether it is published as a printed book.
     We recommend this License principally for works whose purpose is
     instruction or reference.

  1. APPLICABILITY AND DEFINITIONS

     This License applies to any manual or other work, in any medium,
     that contains a notice placed by the copyright holder saying it
     can be distributed under the terms of this License.  Such a notice
     grants a world-wide, royalty-free license, unlimited in duration,
     to use that work under the conditions stated herein.  The
     "Document", below, refers to any such manual or work.  Any member
     of the public is a licensee, and is addressed as "you".  You
     accept the license if you copy, modify or distribute the work in a
     way requiring permission under copyright law.

     A "Modified Version" of the Document means any work containing the
     Document or a portion of it, either copied verbatim, or with
     modifications and/or translated into another language.

     A "Secondary Section" is a named appendix or a front-matter section
     of the Document that deals exclusively with the relationship of the
     publishers or authors of the Document to the Document's overall
     subject (or to related matters) and contains nothing that could
     fall directly within that overall subject.  (Thus, if the Document
     is in part a textbook of mathematics, a Secondary Section may not
     explain any mathematics.)  The relationship could be a matter of
     historical connection with the subject or with related matters, or
     of legal, commercial, philosophical, ethical or political position
     regarding them.

     The "Invariant Sections" are certain Secondary Sections whose
     titles are designated, as being those of Invariant Sections, in
     the notice that says that the Document is released under this
     License.  If a section does not fit the above definition of
     Secondary then it is not allowed to be designated as Invariant.
     The Document may contain zero Invariant Sections.  If the Document
     does not identify any Invariant Sections then there are none.

     The "Cover Texts" are certain short passages of text that are
     listed, as Front-Cover Texts or Back-Cover Texts, in the notice
     that says that the Document is released under this License.  A
     Front-Cover Text may be at most 5 words, and a Back-Cover Text may
     be at most 25 words.

     A "Transparent" copy of the Document means a machine-readable copy,
     represented in a format whose specification is available to the
     general public, that is suitable for revising the document
     straightforwardly with generic text editors or (for images
     composed of pixels) generic paint programs or (for drawings) some
     widely available drawing editor, and that is suitable for input to
     text formatters or for automatic translation to a variety of
     formats suitable for input to text formatters.  A copy made in an
     otherwise Transparent file format whose markup, or absence of
     markup, has been arranged to thwart or discourage subsequent
     modification by readers is not Transparent.  An image format is
     not Transparent if used for any substantial amount of text.  A
     copy that is not "Transparent" is called "Opaque".

     Examples of suitable formats for Transparent copies include plain
     ASCII without markup, Texinfo input format, LaTeX input format,
     SGML or XML using a publicly available DTD, and
     standard-conforming simple HTML, PostScript or PDF designed for
     human modification.  Examples of transparent image formats include
     PNG, XCF and JPG.  Opaque formats include proprietary formats that
     can be read and edited only by proprietary word processors, SGML or
     XML for which the DTD and/or processing tools are not generally
     available, and the machine-generated HTML, PostScript or PDF
     produced by some word processors for output purposes only.

     The "Title Page" means, for a printed book, the title page itself,
     plus such following pages as are needed to hold, legibly, the
     material this License requires to appear in the title page.  For
     works in formats which do not have any title page as such, "Title
     Page" means the text near the most prominent appearance of the
     work's title, preceding the beginning of the body of the text.

     A section "Entitled XYZ" means a named subunit of the Document
     whose title either is precisely XYZ or contains XYZ in parentheses
     following text that translates XYZ in another language.  (Here XYZ
     stands for a specific section name mentioned below, such as
     "Acknowledgements", "Dedications", "Endorsements", or "History".)
     To "Preserve the Title" of such a section when you modify the
     Document means that it remains a section "Entitled XYZ" according
     to this definition.

     The Document may include Warranty Disclaimers next to the notice
     which states that this License applies to the Document.  These
     Warranty Disclaimers are considered to be included by reference in
     this License, but only as regards disclaiming warranties: any other
     implication that these Warranty Disclaimers may have is void and
     has no effect on the meaning of this License.

  2. VERBATIM COPYING

     You may copy and distribute the Document in any medium, either
     commercially or noncommercially, provided that this License, the
     copyright notices, and the license notice saying this License
     applies to the Document are reproduced in all copies, and that you
     add no other conditions whatsoever to those of this License.  You
     may not use technical measures to obstruct or control the reading
     or further copying of the copies you make or distribute.  However,
     you may accept compensation in exchange for copies.  If you
     distribute a large enough number of copies you must also follow
     the conditions in section 3.

     You may also lend copies, under the same conditions stated above,
     and you may publicly display copies.

  3. COPYING IN QUANTITY

     If you publish printed copies (or copies in media that commonly
     have printed covers) of the Document, numbering more than 100, and
     the Document's license notice requires Cover Texts, you must
     enclose the copies in covers that carry, clearly and legibly, all
     these Cover Texts: Front-Cover Texts on the front cover, and
     Back-Cover Texts on the back cover.  Both covers must also clearly
     and legibly identify you as the publisher of these copies.  The
     front cover must present the full title with all words of the
     title equally prominent and visible.  You may add other material
     on the covers in addition.  Copying with changes limited to the
     covers, as long as they preserve the title of the Document and
     satisfy these conditions, can be treated as verbatim copying in
     other respects.

     If the required texts for either cover are too voluminous to fit
     legibly, you should put the first ones listed (as many as fit
     reasonably) on the actual cover, and continue the rest onto
     adjacent pages.

     If you publish or distribute Opaque copies of the Document
     numbering more than 100, you must either include a
     machine-readable Transparent copy along with each Opaque copy, or
     state in or with each Opaque copy a computer-network location from
     which the general network-using public has access to download
     using public-standard network protocols a complete Transparent
     copy of the Document, free of added material.  If you use the
     latter option, you must take reasonably prudent steps, when you
     begin distribution of Opaque copies in quantity, to ensure that
     this Transparent copy will remain thus accessible at the stated
     location until at least one year after the last time you
     distribute an Opaque copy (directly or through your agents or
     retailers) of that edition to the public.

     It is requested, but not required, that you contact the authors of
     the Document well before redistributing any large number of
     copies, to give them a chance to provide you with an updated
     version of the Document.

  4. MODIFICATIONS

     You may copy and distribute a Modified Version of the Document
     under the conditions of sections 2 and 3 above, provided that you
     release the Modified Version under precisely this License, with
     the Modified Version filling the role of the Document, thus
     licensing distribution and modification of the Modified Version to
     whoever possesses a copy of it.  In addition, you must do these
     things in the Modified Version:

       A. Use in the Title Page (and on the covers, if any) a title
          distinct from that of the Document, and from those of
          previous versions (which should, if there were any, be listed
          in the History section of the Document).  You may use the
          same title as a previous version if the original publisher of
          that version gives permission.

       B. List on the Title Page, as authors, one or more persons or
          entities responsible for authorship of the modifications in
          the Modified Version, together with at least five of the
          principal authors of the Document (all of its principal
          authors, if it has fewer than five), unless they release you
          from this requirement.

       C. State on the Title page the name of the publisher of the
          Modified Version, as the publisher.

       D. Preserve all the copyright notices of the Document.

       E. Add an appropriate copyright notice for your modifications
          adjacent to the other copyright notices.

       F. Include, immediately after the copyright notices, a license
          notice giving the public permission to use the Modified
          Version under the terms of this License, in the form shown in
          the Addendum below.

       G. Preserve in that license notice the full lists of Invariant
          Sections and required Cover Texts given in the Document's
          license notice.

       H. Include an unaltered copy of this License.

       I. Preserve the section Entitled "History", Preserve its Title,
          and add to it an item stating at least the title, year, new
          authors, and publisher of the Modified Version as given on
          the Title Page.  If there is no section Entitled "History" in
          the Document, create one stating the title, year, authors,
          and publisher of the Document as given on its Title Page,
          then add an item describing the Modified Version as stated in
          the previous sentence.

       J. Preserve the network location, if any, given in the Document
          for public access to a Transparent copy of the Document, and
          likewise the network locations given in the Document for
          previous versions it was based on.  These may be placed in
          the "History" section.  You may omit a network location for a
          work that was published at least four years before the
          Document itself, or if the original publisher of the version
          it refers to gives permission.

       K. For any section Entitled "Acknowledgements" or "Dedications",
          Preserve the Title of the section, and preserve in the
          section all the substance and tone of each of the contributor
          acknowledgements and/or dedications given therein.

       L. Preserve all the Invariant Sections of the Document,
          unaltered in their text and in their titles.  Section numbers
          or the equivalent are not considered part of the section
          titles.

       M. Delete any section Entitled "Endorsements".  Such a section
          may not be included in the Modified Version.

       N. Do not retitle any existing section to be Entitled
          "Endorsements" or to conflict in title with any Invariant
          Section.

       O. Preserve any Warranty Disclaimers.

     If the Modified Version includes new front-matter sections or
     appendices that qualify as Secondary Sections and contain no
     material copied from the Document, you may at your option
     designate some or all of these sections as invariant.  To do this,
     add their titles to the list of Invariant Sections in the Modified
     Version's license notice.  These titles must be distinct from any
     other section titles.

     You may add a section Entitled "Endorsements", provided it contains
     nothing but endorsements of your Modified Version by various
     parties--for example, statements of peer review or that the text
     has been approved by an organization as the authoritative
     definition of a standard.

     You may add a passage of up to five words as a Front-Cover Text,
     and a passage of up to 25 words as a Back-Cover Text, to the end
     of the list of Cover Texts in the Modified Version.  Only one
     passage of Front-Cover Text and one of Back-Cover Text may be
     added by (or through arrangements made by) any one entity.  If the
     Document already includes a cover text for the same cover,
     previously added by you or by arrangement made by the same entity
     you are acting on behalf of, you may not add another; but you may
     replace the old one, on explicit permission from the previous
     publisher that added the old one.

     The author(s) and publisher(s) of the Document do not by this
     License give permission to use their names for publicity for or to
     assert or imply endorsement of any Modified Version.

  5. COMBINING DOCUMENTS

     You may combine the Document with other documents released under
     this License, under the terms defined in section 4 above for
     modified versions, provided that you include in the combination
     all of the Invariant Sections of all of the original documents,
     unmodified, and list them all as Invariant Sections of your
     combined work in its license notice, and that you preserve all
     their Warranty Disclaimers.

     The combined work need only contain one copy of this License, and
     multiple identical Invariant Sections may be replaced with a single
     copy.  If there are multiple Invariant Sections with the same name
     but different contents, make the title of each such section unique
     by adding at the end of it, in parentheses, the name of the
     original author or publisher of that section if known, or else a
     unique number.  Make the same adjustment to the section titles in
     the list of Invariant Sections in the license notice of the
     combined work.

     In the combination, you must combine any sections Entitled
     "History" in the various original documents, forming one section
     Entitled "History"; likewise combine any sections Entitled
     "Acknowledgements", and any sections Entitled "Dedications".  You
     must delete all sections Entitled "Endorsements."

  6. COLLECTIONS OF DOCUMENTS

     You may make a collection consisting of the Document and other
     documents released under this License, and replace the individual
     copies of this License in the various documents with a single copy
     that is included in the collection, provided that you follow the
     rules of this License for verbatim copying of each of the
     documents in all other respects.

     You may extract a single document from such a collection, and
     distribute it individually under this License, provided you insert
     a copy of this License into the extracted document, and follow
     this License in all other respects regarding verbatim copying of
     that document.

  7. AGGREGATION WITH INDEPENDENT WORKS

     A compilation of the Document or its derivatives with other
     separate and independent documents or works, in or on a volume of
     a storage or distribution medium, is called an "aggregate" if the
     copyright resulting from the compilation is not used to limit the
     legal rights of the compilation's users beyond what the individual
     works permit.  When the Document is included in an aggregate, this
     License does not apply to the other works in the aggregate which
     are not themselves derivative works of the Document.

     If the Cover Text requirement of section 3 is applicable to these
     copies of the Document, then if the Document is less than one half
     of the entire aggregate, the Document's Cover Texts may be placed
     on covers that bracket the Document within the aggregate, or the
     electronic equivalent of covers if the Document is in electronic
     form.  Otherwise they must appear on printed covers that bracket
     the whole aggregate.

  8. TRANSLATION

     Translation is considered a kind of modification, so you may
     distribute translations of the Document under the terms of section
     4.  Replacing Invariant Sections with translations requires special
     permission from their copyright holders, but you may include
     translations of some or all Invariant Sections in addition to the
     original versions of these Invariant Sections.  You may include a
     translation of this License, and all the license notices in the
     Document, and any Warranty Disclaimers, provided that you also
     include the original English version of this License and the
     original versions of those notices and disclaimers.  In case of a
     disagreement between the translation and the original version of
     this License or a notice or disclaimer, the original version will
     prevail.

     If a section in the Document is Entitled "Acknowledgements",
     "Dedications", or "History", the requirement (section 4) to
     Preserve its Title (section 1) will typically require changing the
     actual title.

  9. TERMINATION

     You may not copy, modify, sublicense, or distribute the Document
     except as expressly provided for under this License.  Any other
     attempt to copy, modify, sublicense or distribute the Document is
     void, and will automatically terminate your rights under this
     License.  However, parties who have received copies, or rights,
     from you under this License will not have their licenses
     terminated so long as such parties remain in full compliance.

 10. FUTURE REVISIONS OF THIS LICENSE

     The Free Software Foundation may publish new, revised versions of
     the GNU Free Documentation License from time to time.  Such new
     versions will be similar in spirit to the present version, but may
     differ in detail to address new problems or concerns.  See
     `http://www.gnu.org/copyleft/'.

     Each version of the License is given a distinguishing version
     number.  If the Document specifies that a particular numbered
     version of this License "or any later version" applies to it, you
     have the option of following the terms and conditions either of
     that specified version or of any later version that has been
     published (not as a draft) by the Free Software Foundation.  If
     the Document does not specify a version number of this License,
     you may choose any version ever published (not as a draft) by the
     Free Software Foundation.

ADDENDUM: How to use this License for your documents
====================================================

To use this License in a document you have written, include a copy of
the License in the document and put the following copyright and license
notices just after the title page:

       Copyright (C)  YEAR  YOUR NAME.
       Permission is granted to copy, distribute and/or modify this document
       under the terms of the GNU Free Documentation License, Version 1.2
       or any later version published by the Free Software Foundation;
       with no Invariant Sections, no Front-Cover Texts, and no Back-Cover
       Texts.  A copy of the license is included in the section entitled ``GNU
       Free Documentation License''.

   If you have Invariant Sections, Front-Cover Texts and Back-Cover
Texts, replace the "with...Texts." line with this:

         with the Invariant Sections being LIST THEIR TITLES, with
         the Front-Cover Texts being LIST, and with the Back-Cover Texts
         being LIST.

   If you have Invariant Sections without Cover Texts, or some other
combination of the three, merge those two alternatives to suit the
situation.

   If your document contains nontrivial examples of program code, we
recommend releasing these examples in parallel under your choice of
free software license, such as the GNU General Public License, to
permit their use in free software.



Tag Table:
Node: Top638
Node: Introduction1288
Node: Why another e-mail client?1574
Node: Other mail clients2242
Ref: Other mail clients-Footnote-12984
Ref: Other mail clients-Footnote-23017
Ref: Other mail clients-Footnote-33060
Ref: Other mail clients-Footnote-43096
Ref: Other mail clients-Footnote-53132
Node: What mu4e does and doesn't do3163
Ref: What mu4e does and doesn't do-Footnote-14124
Ref: What mu4e does and doesn't do-Footnote-24158
Ref: What mu4e does and doesn't do-Footnote-34198
Node: Getting started4235
Node: Installation4762
Ref: Installation-Footnote-16107
Node: Getting mail6214
Node: Indexing your messages7682
Ref: Indexing your messages-Footnote-19109
Node: Sending mail9226
Node: Queuing mail11120
Node: Basic configuration12376
Node: Running mu4e13303
Node: Main view14979
Node: Headers view17667
Ref: Headers view-Footnote-121715
Node: Message view21763
Ref: Message view-Footnote-126285
Ref: Message view-Footnote-226504
Ref: Message view-Footnote-326552
Node: Editor view26594
Node: Searching mail27876
Node: Queries28815
Node: Bookmarks30404
Ref: Bookmarks-Footnote-132966
Node: Maildir searches33009
Node: Interaction with other tools34838
Node: Creating org-mode links35268
Node: Maintaining an address-book with org-contacts36204
Ref: Maintaining an address-book with org-contacts-Footnote-136931
Node: Getting new mail notifications with Sauron36992
Ref: Getting new mail notifications with Sauron-Footnote-138557
Node: Speedbar support38701
Node: Example configuration39365
Node: Minimal configuration39697
Node: Longer configuration40671
Node: Gmail configuration43244
Node: FAQ - Frequently Anticipated Questions47437
Node: Known issues / missing features50199
Node: How it works51941
Node: High-level overview52315
Node: mu server53812
Node: Reading from the server54847
Node: GNU Free Documentation License56789

End Tag Table


Local Variables:
coding: utf-8
End:
